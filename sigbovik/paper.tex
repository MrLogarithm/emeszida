% This must be in the first 5 lines to tell arXiv to use pdfLaTeX, which is strongly recommended.
% \pdfoutput=1
% In particular, the hyperref package requires pdfLaTeX in order to break URLs across lines.

\documentclass[11pt]{article}

% Change "review" to "final" to generate the final (sometimes called camera-ready) version.
% Change to "preprint" to generate a non-anonymous version with page numbers.
\usepackage[]{acl}

% Standard package includes
\usepackage{times}
\usepackage{latexsym}

% For proper rendering and hyphenation of words containing Latin characters (including in bib files)
\usepackage[T1]{fontenc}
% For Vietnamese characters
% \usepackage[T5]{fontenc}
% See https://www.latex-project.org/help/documentation/encguide.pdf for other character sets
\usepackage{fontspec}
\newfontface{\cuneiform}[Scale=MatchUppercase,Path=./font/]{NotoSansCuneiform-Regular.ttf}
\DeclareTextFontCommand{\textcuneiform}{\cuneiform}

% % Needed for cuneiform abstract
% \newenvironment{cuneiformabstract}%
% 		 {\centerline{\large\bf Cuneiform Abstract}%
% 		  \begin{list}{}%
% 		     {\setlength{\rightmargin}{0.6cm}%
% 		      \setlength{\leftmargin}{0.6cm}}%
% 		   \item[]\ignorespaces%
% 		   \@setsize\normalsize{12pt}\xpt\@xpt
% 		   }%
% 		 {\unskip\end{list}}


% This assumes your files are encoded as UTF8
\usepackage[utf8]{inputenc}

% This is not strictly necessary, and may be commented out,
% but it will improve the layout of the manuscript,
% and will typically save some space.
\usepackage{microtype}

% This is also not strictly necessary, and may be commented out.
% However, it will improve the aesthetics of text in
% the typewriter font.
\usepackage{inconsolata}

%Including images in your LaTeX document requires adding
%additional package(s)
\usepackage{graphicx}

\usepackage{longtable}

% \setmainfont[Ligatures=TeX]{Times New Roman}
\newfontfamily\arabicfont
    [Script=Arabic,     % to get correct arabic shaping
    Scale=1.2]          % make the arabic font bigger, a matter of taste
        {Arial}     % whatever Arabic font you like

\newcommand{\textarabic}[1]     % Arabic inside LTR
    {\bgroup\textdir TRT\arabicfont #1\egroup}
\newcommand{\n}         [1]     % for digits inside Arabic text
    {\bgroup\textdir TLT #1\egroup}
\newcommand{\afootnote} [1]     % Arabic footnotes
    {\footnote{\textarabic{#1}}}
\newenvironment{Arabic}     % Arabic paragraph
    {\textdir TRT\pardir TRT\arabicfont}{}

% If the title and author information does not fit in the area allocated, uncomment the following
%
%\setlength\titlebox{<dim>}
%
% and set <dim> to something 5cm or larger.

\newcommand{\emeszida}{\textcuneiform{ğ’…´ğ’‹ƒğ’€€}}

\title{\emeszida}

% Author information can be set in various styles:
% For several authors from the same institution:
% \author{Author 1 \and ... \and Author n \\
%         Address line \\ ... \\ Address line}
% if the names do not fit well on one line use
%         Author 1 \\ {\bf Author 2} \\ ... \\ {\bf Author n} \\
% For authors from different institutions:
% \author{Author 1 \\ Address line \\  ... \\ Address line
%         \And  ... \And
%         Author n \\ Address line \\ ... \\ Address line}
% To start a separate ``row'' of authors use \AND, as in
% \author{Author 1 \\ Address line \\  ... \\ Address line
%         \AND
%         Author 2 \\ Address line \\ ... \\ Address line \And
%         Author 3 \\ Address line \\ ... \\ Address line}

\author{First Author \\
  Affiliation / Address line 1 \\
  Affiliation / Address line 2 \\
  Affiliation / Address line 3 \\
  \texttt{email@domain} \\\And
  Second Author \\
  Affiliation / Address line 1 \\
  Affiliation / Address line 2 \\
  Affiliation / Address line 3 \\
  \texttt{email@domain} \\}

%\author{
%  \textbf{First Author\textsuperscript{1}},
%  \textbf{Second Author\textsuperscript{1,2}},
%  \textbf{Third T. Author\textsuperscript{1}},
%  \textbf{Fourth Author\textsuperscript{1}},
%\\
%  \textbf{Fifth Author\textsuperscript{1,2}},
%  \textbf{Sixth Author\textsuperscript{1}},
%  \textbf{Seventh Author\textsuperscript{1}},
%  \textbf{Eighth Author \textsuperscript{1,2,3,4}},
%\\
%  \textbf{Ninth Author\textsuperscript{1}},
%  \textbf{Tenth Author\textsuperscript{1}},
%  \textbf{Eleventh E. Author\textsuperscript{1,2,3,4,5}},
%  \textbf{Twelfth Author\textsuperscript{1}},
%\\
%  \textbf{Thirteenth Author\textsuperscript{3}},
%  \textbf{Fourteenth F. Author\textsuperscript{2,4}},
%  \textbf{Fifteenth Author\textsuperscript{1}},
%  \textbf{Sixteenth Author\textsuperscript{1}},
%\\
%  \textbf{Seventeenth S. Author\textsuperscript{4,5}},
%  \textbf{Eighteenth Author\textsuperscript{3,4}},
%  \textbf{Nineteenth N. Author\textsuperscript{2,5}},
%  \textbf{Twentieth Author\textsuperscript{1}}
%\\
%\\
%  \textsuperscript{1}Affiliation 1,
%  \textsuperscript{2}Affiliation 2,
%  \textsuperscript{3}Affiliation 3,
%  \textsuperscript{4}Affiliation 4,
%  \textsuperscript{5}Affiliation 5
%\\
%  \small{
%    \textbf{Correspondence:} \href{mailto:email@domain}{email@domain}
%  }
%}

\begin{document}
\maketitle
\begin{abstract}
This paper announces the discovery of the use of neural nets almost 4,000 years before their use in the modern era.
Newly discovered tablets preserve a perceptron used for calculating the numbers on Plimpton 322, the most important object in the history of mathematics.
The native programming language used by the ancient Babylonian ``cuneogrammers'' uses sexagesimal numbering leading to some ``weirdness''.
\end{abstract}

\begin{abstract}[\cuneiform{ğ’‰†ğ’†¸}]
\cuneiform{ğ’€­ğ’‰ğ’¾ğ’……ğ’‰ˆğ’ˆ ğ’Œğ’ˆ ğ’Šºğ’€ªğ’ƒ»ğ’Œºğ’ƒŒğ’€€ğ’²}
\cuneiform{ğ’‰ğ’…†ğ’…†ğ’Œ“ğ’‚Šğ’¹ğ’…†ğ’¾ğ’Œğ’ƒ»ğ’‰†ğ’…†ğ’Œ‡ğ’€­ğ’‰ğ’‰†}
\cuneiform{ğ’…†ğ’€¸ğ’¾ğ’‰¿ğ’‡·ğ’…ğ’†—ğ’Šğ’™ğ’ˆ«ğ’†•ğ’¾ğ’‰¿ğ’‡·ğ’…}
\cuneiform{ğ’†—ğ’Šğ’™ğ’ˆ«ğ’ˆ¤ğ’ƒ²ğ’€¸ğ’„’ğ’‹¥ğ’‡¹ğ’‹¾ğ’…´ğ’‹ƒğ’€€ğ’Š­ğ’†³}
\cuneiform{ğ’…´ğ’‚ ğ’…‡ğ’Œµğ’† ğ’…´ğ’‹ƒğ’€€ğ’¾ğ’Š¬ğ’†•ğ’Œğ’€­ğ’‰}
\cuneiform{ğ’…´ğ’‹—ğ’…†ğ’Œ‘ğ’‹ƒğ’Œğ’Œ‡ğ’Š­ğ’„‘ğ’}
\end{abstract}

\section{Introduction}
The history of math is long, but the history of programming is longer.
Cuneiform, arguably the first writing in the world, is known for its sheep receipts and beer ration lists as well as complaints about substandard copper \cite{oppenheim1954} and women complaining at each other \cite{Matuszak2020}.
This article adds neural network programming to that vaunted list of human achievements.
A set of newly discovered cuneiform tablets preserve the mechanism for performing simple neural network calculations.
These methods, it seems, were used to calculate the lengths of triangles; a well known example of this exercise is preserved on the tablet known as Plimpton 322\footnote{An important and real description of this interesting object is found in \citet{robson2002}.}.
It is remarkable that no historian of math or cuneiform scholar has ever consider this possibility.
This paper covers the background, a description of the cuneogramming language, and includes a facsimile copy of the most important tablet as an appendix.

Unfortunately, the hardware required to execute these programs (i.e. a living Babylonian mathematician) has not been adequately preserved, but we have managed to write a Python library which emulates it.\footnote{\url{github.com/MrLogarithm/emeszida}}
The assumption is that these calculations were done by hand in their copious free time between inventing the wheel and the concept of zero.
While the actual output of these tablets is relatively simple by modern standards, the implications of this discovery are profound.
Future work will explore how these techniques could have been used in the realm of astronomical calculation and elucidate the full extent of Babylonian computational prowess.

\section{Description of the Language}
Programs in \emeszida\ (\textsc{eme.Å¡id.a} "language of counting") follow a tabular structure with three main sections: (i) a header, denoted by \textcuneiform{ğ’¾} (\textsc{dub}  "tablet"), (ii) a sequence of instructions, and (iii) a colophon detailing the tablet's authorship.
Each instruction spans four columns, which we have taken to calling the \textit{arguments}, \textit{opcode}, \textit{destination}, and \textit{line number}. 
These columns are usually tab-separated, though in a few documents they are TAB-separated (using the cuneiform sign \textsc{tab} \textcuneiform{ğ’‹°}).
Instructions are grouped into blocks by means of horizontal lines.

\paragraph{Arguments}
An instruction's arguments may be numbers, register addresses, or a combination of the two. Numbers are encoded following standard Babylonian conventions, with \textcuneiform{ğ’‹™} denoting the radix point which separates the integer part from a following fraction. There is an explicit representation for zero (\textcuneiform{ğ’‘±}), making these tablets some of the earliest unambigiuous examples of the mathematical concept of zero.

A register address is denoted by the phrase \textsc{niÅ‹$_2$.kas$_7$} $n$-\textsc{kam} \textcuneiform{ğ’ƒ»ğ’‹ƒ}$n$\textcuneiform{ğ’„°} (``thing.account $n$-th'', ``the item in the $n$-th place''), where $n$ is any number. \textcuneiform{ğ’ƒ»ğ’‹ƒ} expressions can be nested to perform a kind of pointer dereferencing: for example, if \textcuneiform{ğ’ƒ»ğ’‹ƒğ’•ğ’„°} (register 1) contains the value \textcuneiform{ğ’—} (3), and \textcuneiform{ğ’ƒ»ğ’‹ƒğ’—ğ’„°} (register 3) contains the value \textcuneiform{ğ’›} (7), then \textcuneiform{ğ’ƒ»ğ’‹ƒğ’ƒ»ğ’‹ƒğ’•ğ’„°ğ’„°} will evaluate to 7 (the value in the register pointed to by \textcuneiform{ğ’ƒ»ğ’‹ƒğ’•ğ’„°}).

If an instruction has multiple arguments, these must be delimited by a wide space (distinct from the short space used to separate groups of digits within a number), or by one of the phrases \textit{a-na} \textcuneiform{ğ’€€ğ’ˆ¾} ``to'' or \textit{i-na} \textcuneiform{ğ’„¿ğ’ˆ¾} ``from''. By convention, the choice of delimiter depends on the instruction's opcode (see below), with multiplication operations preferring space delimiters, addition preferring \textcuneiform{ğ’€€ğ’ˆ¾}, and subtraction preferring \textcuneiform{ğ’„¿ğ’ˆ¾}. 
There is no mechanism to enforce these conventions, but we recommend following them because \emeszida\ is hard enough to read at the best of times.

\paragraph{Destination}
In most cases, the destination column of an instruction will be a register address where the output is to be stored, e.g. \textcuneiform{ğ’ƒ»ğ’‹ƒğ’•ğ’„°}. 
Some control-flow instructions (see below) instead expect the destination to be a line number. 
\textcuneiform{ğ’‹¤} \textsc{sud} (``distant, remote'') can be used as a null destination, for statements which produce no output.

\paragraph{Opcodes}
Each instruction has a single opcode belonging to the following vocabulary:
\begin{itemize}
    \item \textcuneiform{ğ’ˆ­ğ’„©} \textsc{daá¸«.á¸«a}, ``add''
    \item \textcuneiform{ğ’€ğ’£} \textsc{ba.zi}, ``tear out''
    \item \textcuneiform{ğ’€€ğ’º} \textsc{a.raâ‚‚}, ``multiply''
    \item \textcuneiform{ğ’…†} \textsc{igi}, ``reciprocal''
    \item \textcuneiform{ğ’ˆ¨} \textsc{me}, ``to be''
    \item \textcuneiform{ğ’…†ğ’‚ƒ} \textit{ta-mar}, ``you will see''
    \item \textcuneiform{ğ’‡”ğ’ˆ¾} \textsc{nigin.na}, ``start again''
    \item \textcuneiform{ğ’‹—ğ’Œ‰ğ’‰ğ’‹›ğ’€€} \textsc{tukum.bi dirig}, ``if it exceeds''
    \item \textcuneiform{ğ’‹—ğ’Œ‰ğ’‰ğ’‹}  \textsc{tukum.bi sig}, ``if it it is weak''
\end{itemize}

The first three of these are binary operators for addition, subtraction, and multiplication respectively. 
The subtraction operator deserves special attention for its use in constructions of the following shape, which appear hundreds of times throughout the Babylonian programming corpus:

\begin{center}
    \textcuneiform{ğ’‘±ğ’‹™ğ’–ğ’Œğ’„¿ğ’ˆ¾ğ’‘±}\qquad\textcuneiform{ğ’€ğ’£}\qquad\textcuneiform{ğ’ƒ»ğ’‹ƒğ’•ğ’„°}\qquad\textcuneiform{ğ’‘±}
\end{center}

This instruction subtracts \textcuneiform{ğ’‘±ğ’‹™ğ’–ğ’Œ} from zero and stores the result in \textcuneiform{ğ’ƒ»ğ’‹ƒğ’•ğ’„°}. 
This effectively negates the first argument, and seems to have been the primary way by which Babylonian cuneogrammers represented negative numbers, as their primitive and archaic notation otherwise lacked a means to encode such values.
This curious practice gives definitive proof that the invention of negative numbers occurred centuries earlier than previously believed.

The language does not appear to have any kind of binary division operator. Rather, a unary \textcuneiform{ğ’…†} operator was used to find the reciprocal of the denominator, which was then multiplied by the numerator using the binary \textcuneiform{ğ’€€ğ’º} operator.

\textcuneiform{ğ’ˆ¨} is a unary assignment operator which stores a value in a destination register. \textcuneiform{ğ’…†ğ’‚ƒ} functions as a unary print operator.

\emeszida\ includes three types of control-flow instructions. \textcuneiform{ğ’‡”ğ’ˆ¾} functions like GOTO, and jumps the program counter to the specified line number. \textcuneiform{ğ’‹—ğ’Œ‰ğ’‰ğ’‹} functions like the x86 \texttt{jz} instruction, and jumps to the specified line number if and only if its argument is zero. \textcuneiform{ğ’‹—ğ’Œ‰ğ’‰ğ’‹›ğ’€€} is similar, and jumps if the argument is greater than zero.

% Added here to end up on next page
\begin{figure*}
    \centering
    \includegraphics[width=\textwidth]{BM_34580.jpg}
    \caption{BM 34580, courtesy of the Trustees of the British Museum, CC BY-NC-SA 4.0}
    \label{fig:BM_34580}
  \end{figure*}

\paragraph{Line Numbers}
Every line of an \emeszida\ program ends in a mandatory line number. 
However, these numbers are not generally sequential, and need not even be distinct. 
For example, most lines of the perceptron tablet are labeled with the number \textcuneiform{ğ’‘±} (zero); only lines that are the destination of some control-flow instruction receive non-zero identifiers. 

\subsection{Fractional Indexing}
Both line numbers and register addresses in \emeszida\ can have fractional parts.
The original scribes seem to have exploited this fact to establish non-overlapping ``namespaces'' for the different parts of their code. 
For example, in the perceptron tablet, all of the model parameters are stored in adresses with integer part 1; the program inputs all have integer part 2; the matrix multiplication subroutine uses addresses with integer part 3; and so on.
The fractional parts of register addresses also appear to follow some standard conventions, with the X;0 register typically storing a subroutine's return address, while X;1 onward were used for its arguments.

The perceptron tablet also uses fractional register addresses to perform a kind of multi-dimensional array indexing.
As an example, the first layer of the perceptron has a $50\times 2$ weight matrix, and this is stored in registers 1;0,0,0 through 1;0,49,1. The integer part of these addresses denotes the ``data'' portion of memory; the first digit after the radix point identifies this as the 0th model parameter; and the second and third digits can be treated as a pair of indices ranging from 0--49 and 0--1 respectively.
To access a specific element in this matrix, the scribes use repeated division by 60 to implement a kind of ``bit-shift'' instruction, in order to shift integer indices into the correct positions after the radix point. 
By adding the bit-shifted element indices (e.g. 0;0,4,7 for the element in row 5, column 8) to a pointer to the top corner of the matrix (1;0,0,0) they obtain the address of the desired element (1;0,4,7).

Notably, this practice limits the size of their model parameters to at most $60\times 60$, as for larger values the addresses would carry over to higher digits and thus begin to overwrite one another. 
This limitation may explain why AI never made waves in Babylonian society, as their models were all too small to be truly revolutionary.

\section{Description of the Texts}
The cuneogramming corpus contains numerous fragments implementing recognizable procedures such as bit-shifting, populating an array, computing dot products, and so on. 
However, only a single text is known to have been preserved in its entirety.\footnote{All of the known texts are reproduced in \url{github.com/MrLogarithm/emeszida/tree/main/programs}, and the long text is reproduced in facsimile in the appendix of this work.}
Spanning close to 1700 lines, this impressive text is divided into five sections implementing what modern readers will immediately recognize to be a multi-layer perception.
The first section straightforwadly defines a matrix-multiplication subroutine. 
This is called by a subroutine defined in section two, which applies each layer of the perceptron to a given input, and applies a ReLU-style activation between each pair of layers.
Section three implements the tablet's ``main'' method, which loads an input to memory, calls the perceptron subroutine, and prints the resulting output.
Section four loads the model parameters, which appear to comprise weight matrices of sizes $50\times 2$, $25\times 50$, and $1\times 25$, plus bias vectors of sizes $50$, $25$, and $1$ respectively.
The final section lists pairs of inputs, whose values (incredibly!) correspond to the second and third columns of Plimpton 322.
Interestingly, this section very closely resembles the tables of parameters found in later astronomical calculations (see Figure \ref{fig:BM_34580}).

When the program is executed, it produces a single numeric output for each input pair. 
These outputs correspond remarkably closely to the values in the first column of Plimpton 322, as demonstrated in Figure~\ref{fig:graph}.
The correspondence is not perfect, however, and the values which should match lines 1, 5, and 6 of Plimpton 322 are significantly larger than expected.
This implies that, although the code on this tablet is clearly \textit{related} to Plimpton 322, it could not have been used to directly populate the table in that text.
Perhaps the outputs from this model were refined in some later step to produce the more exact ratios in the Plimpton text, or perhaps the Babylonians were disillusioned by the imprecision of their machine learning models and simply abandoned them for tried-and-true manual methods. 
Given how miniscule the cuneogramming corpus is relative to the larger body of Babylonian administrative writing, we lean towards the latter explanation.

\begin{figure}
    \includegraphics[width=0.5\textwidth]{graph.png}
    \caption{Outputs from the perceptron tablet vs.\ true value of each line from column 1 of Plimpton 322. If a point falls upon the line, the model output for that line exactly equals the value on Plimpton 322.}
    \label{fig:graph}
\end{figure}

%It is clear that the cuneogrammers were slowly developing their skills as some of the earlier and simpler methods date as far back as the Old Akkadian period (c. 2300--2150 BCE) while the perceptron tablet is from the Old Babylonian period (c. 1900--1600 BCE).

\section{Implications}
This completely rewrites the history of modern computing... 

Other ancient corpora which have resisted decipherment, and which boast a similar numeric component, may represent additional examples of ancient programming traditions \cite{kelley2022}.

- compare the table of params at the end of the file to tables of astronomical parameters from genuine tablets


\section*{Acknowledgments}
The search for these tablets and our effort to understand them was inspired by Ramsey Nasser's \textarabic{Ù‚Ù„Ø¨} programming language (https://github.com/nasser/---).

\bibliography{custom}

\appendix

\section{Example Appendix}
\label{sec:appendix}

- reproduce entire perceptron-full.eme in the text, without comments:

\onecolumn
\tiny
\noindent
\input{perceptron.tex}
\normalsize

\end{document}

