import unittest

import emeszida
from emeszida import Sexagesimal

p = emeszida.EmeszidaParser
t = emeszida.EmeszidaTransformer()

TEMPLATE = """ð’¾
{}
---
colophon"""

class TestNumerals(unittest.TestCase):
    def test_numbers(self):
        TEST_CASES = [
            # 1 through 61:
            ("ð’•	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(1, 0)])}),
            ("ð’–	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(2, 0)])}),
            ("ð’—	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(3, 0)])}),
            ("ð’˜	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(4, 0)])}),
            ("ð’™	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(5, 0)])}),
            ("ð’š	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(6, 0)])}),
            ("ð’›	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(7, 0)])}),
            ("ð’œ	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(8, 0)])}),
            ("ð’	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(9, 0)])}),
            ("ð’Œ‹	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(10, 0)])}),
            ("ð’Œ‹ð’•	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(11, 0)])}),
            ("ð’Œ‹ð’–	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(12, 0)])}),
            ("ð’Œ‹ð’—	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(13, 0)])}),
            ("ð’Œ‹ð’˜	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(14, 0)])}),
            ("ð’Œ‹ð’™	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(15, 0)])}),
            ("ð’Œ‹ð’š	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(16, 0)])}),
            ("ð’Œ‹ð’›	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(17, 0)])}),
            ("ð’Œ‹ð’œ	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(18, 0)])}),
            ("ð’Œ‹ð’	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(19, 0)])}),
            ("ð’Ž™	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(20, 0)])}),
            ("ð’Ž™ð’•	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(21, 0)])}),
            ("ð’Ž™ð’–	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(22, 0)])}),
            ("ð’Ž™ð’—	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(23, 0)])}),
            ("ð’Ž™ð’˜	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(24, 0)])}),
            ("ð’Ž™ð’™	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(25, 0)])}),
            ("ð’Ž™ð’š	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(26, 0)])}),
            ("ð’Ž™ð’›	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(27, 0)])}),
            ("ð’Ž™ð’œ	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(28, 0)])}),
            ("ð’Ž™ð’	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(29, 0)])}),
            ("ð’Œ	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(30, 0)])}),
            ("ð’Œð’•	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(31, 0)])}),
            ("ð’Œð’–	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(32, 0)])}),
            ("ð’Œð’—	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(33, 0)])}),
            ("ð’Œð’˜	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(34, 0)])}),
            ("ð’Œð’™	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(35, 0)])}),
            ("ð’Œð’š	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(36, 0)])}),
            ("ð’Œð’›	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(37, 0)])}),
            ("ð’Œð’œ	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(38, 0)])}),
            ("ð’Œð’	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(39, 0)])}),
            ("ð’	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(40, 0)])}),
            ("ð’ð’•	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(41, 0)])}),
            ("ð’ð’–	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(42, 0)])}),
            ("ð’ð’—	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(43, 0)])}),
            ("ð’ð’˜	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(44, 0)])}),
            ("ð’ð’™	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(45, 0)])}),
            ("ð’ð’š	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(46, 0)])}),
            ("ð’ð’›	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(47, 0)])}),
            ("ð’ð’œ	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(48, 0)])}),
            ("ð’ð’	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(49, 0)])}),
            ("ð’	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(50, 0)])}),
            ("ð’ð’•	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(51, 0)])}),
            ("ð’ð’–	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(52, 0)])}),
            ("ð’ð’—	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(53, 0)])}),
            ("ð’ð’˜	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(54, 0)])}),
            ("ð’ð’™	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(55, 0)])}),
            ("ð’ð’š	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(56, 0)])}),
            ("ð’ð’›	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(57, 0)])}),
            ("ð’ð’œ	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(58, 0)])}),
            ("ð’ð’	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(59, 0)])}),
            ("ð’•ð’‘±	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(1, 1), (0, 0)])}),
            ("ð’•ð’•	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(1, 1), (1, 0)])}),
            # Fractions
            ("ð’‹™ð’•	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(1, -1)])}),
            ("ð’‹™ð’Œ‹ð’•	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(11, -1)])}),
            ("ð’‹™ð’Œð’•	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(31, -1)])}),
            ("ð’‹™ð’Œð’•ð’•	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(31, -1), (1, -2)])}),
            ("ð’‹™ð’Œ‹ð’•ð’ð’•	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(11, -1), (41, -2)])}),
            ("ð’‹™ð’Œ‹ð’•ð’Œð’•ð’Œ‹	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(11, -1), (31, -2), (10, -3)])}),
            ("ð’Œ‹ð’‹™ð’•	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(10, 0), (1, -1)])}),
            ("ð’•ð’‹™ð’Œð’•	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(1, 0), (31, -1)])}),
            (
                "ð’•ð’Œð’‹™ð’Œð’•ð’•	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•",
                {((1,0),): Sexagesimal([(1, 1), (30, 0), (31, -1), (1, -2)])},
            ),
            (
                "ð’•ð’•ð’‹™ð’Œ‹ð’•ð’ð’•	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•",
                {((1,0),): Sexagesimal([(1, 1), (1, 0), (11, -1), (41, -2)])},
            ),
            (
                "ð’•ð’ð’‹™ð’Œ‹ð’•ð’Œð’•ð’Œ‹	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•",
                {((1,0),): Sexagesimal(
                    [(1, 1), (40, 0), (11, -1), (31, -2), (10, -3)]
                )},
            ),
            # Zero
            ("ð’•ð’‘±ð’•	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(1, 2), (0, 1), (1, 0)])}),
            ("ð’•ð’‘±	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(1, 1), (0, 0)])}),
            # Misc
            ("ð’Œ‹ð’•ð’Œð’•ð’Œ‹	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(11, 2), (31, 1), (10, 0)])}),
            ("ð’•ð’Œ‹	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(1, 1), (10, 0)])}),
            ("ð’•ð’Œ‹ð’•	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(1, 1), (11, 0)])}),
            ("ð’•ð’•ð’Œ‹	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(1, 2), (1, 1), (10, 0)])}),
            ("ð’–ð’Œ‹	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(2, 1), (10, 0)])}),
            ("ð’Œ‹ð’‘±ð’Œ‹ð’•	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(10, 2), (0, 1), (11, 0)])}),
            # Spaces
            ("ð’Œ‹ð’•	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(11, 0)])}),
            ("ð’Œ‹ ð’•	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(10, 1), (1, 0)])}),
            ("ð’Œ‹ð’Œ‹ð’•	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(10, 1), (11, 0)])}),
            ("ð’Œ‹ ð’Œ‹ð’•	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(10, 1), (11, 0)])}),
            ("ð’Œ‹ ð’Œ‹ ð’•	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(10, 2), (10, 1), (1, 0)])}),
            ("ð’Œ‹ð’Œ‹ ð’•	ð’ˆ¨	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•",  {((1,0),): Sexagesimal([(10, 2), (10, 1), (1, 0)])}),
        ]

        for string, expected_value in TEST_CASES:
            tree = p.parse(TEMPLATE.format(string))
            program = t.transform(tree)
            program.execute()
            for register, value in expected_value.items():
                self.assertEqual(program.registers[register], value)

    def test_negatives(self):
        TEST_CASES = [
            (
                # +ve - +ve
                # 4 - 1 = -3
                "ð’˜ð’„¿ð’ˆ¾ð’•		ð’€ð’£	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", 
                {
                    ((1,0),): Sexagesimal([(-3,0)]),
                }
            ),
            (
                # Alternate constructor for Sexagesimal
                # 4 - 1 = -3
                "ð’˜ð’„¿ð’ˆ¾ð’•		ð’€ð’£	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", 
                {
                    ((1,0),): Sexagesimal([(3,0)], sign=-1),
                }
            ),
            (
                # Alternative constructor for Sexagesimal
                # 12 - 2,13 = -2,1
                "ð’–ð’Œ‹ð’—ð’„¿ð’ˆ¾ð’Œ‹ð’–		ð’€ð’£	ð’ƒ»ð’‹ƒð’–ð’„°	ð’•", 
                {
                    ((2,0),): Sexagesimal("-2,1"),
                }
            ),
            (
                # -ve * +ve
                # 4 - 1  = -3
                # -3 * 5 = -15
                "ð’˜ð’„¿ð’ˆ¾ð’•		ð’€ð’£	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•\nð’ƒ»ð’‹ƒð’•ð’„°  ð’™		ð’€€ð’º	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", 
                {
                    ((1,0),): Sexagesimal("-15"),
                }
            ),
            (
                # Reciprocal of -ve
                # 4 - 1 = -3
                # -3 * 5 = -15
                # 1 / -15 = -0;4
                "ð’˜ð’„¿ð’ˆ¾ð’•		ð’€ð’£	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•\nð’ƒ»ð’‹ƒð’•ð’„°  ð’™		ð’€€ð’º	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•\nð’ƒ»ð’‹ƒð’•ð’„°	ð’…†	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", 
                {
                    ((1,0),): Sexagesimal("-0;4"),
                }
            ),
            (
                # +ve - +ve, multiple digits
                # 1,12 - 2,13 = -1,1
                "ð’–ð’Œ‹ð’—ð’„¿ð’ˆ¾ð’•ð’Œ‹ð’–		ð’€ð’£	ð’ƒ»ð’‹ƒð’–ð’„°	ð’•", 
                {
                    ((2,0),): Sexagesimal("-1,1"),
                }
            ),
            (
                # +ve - +ve, different number of digits 
                # 12 - 2,13 = -2,1
                "ð’–ð’Œ‹ð’—ð’„¿ð’ˆ¾ð’Œ‹ð’–		ð’€ð’£	ð’ƒ»ð’‹ƒð’–ð’„°	ð’•", 
                {
                    ((2,0),): Sexagesimal("-2,1"),
                }
            ),
            (
                # +ve - +ve, fraction
                # 10;5 - 21;13,4 = -11;8,4
                "ð’Ž™ð’•ð’‹™ð’Œ‹ð’—ð’˜ð’„¿ð’ˆ¾ð’Œ‹ð’‹™ð’™		ð’€ð’£	ð’ƒ»ð’‹ƒð’–ð’„°	ð’•", 
                {
                    ((2,0),): Sexagesimal("-11;8,4"),
                }
            ),
            (
                # +ve - +ve, fraction with carry
                # 10;13,4 - 21;5 = -10;51,56
                "ð’Ž™ð’•ð’‹™ð’™ð’„¿ð’ˆ¾ð’Œ‹ð’‹™ð’Œ‹ð’—ð’˜		ð’€ð’£	ð’ƒ»ð’‹ƒð’–ð’„°	ð’•", 
                {
                    ((2,0),): Sexagesimal("-10;51,56"),
                }
            ),
            (
                # +ve - -ve
                # 0 - 5 = -5
                # 4 - -5 = 9
                "ð’™ð’„¿ð’ˆ¾ð’‘±	ð’€ð’£	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•\nð’ƒ»ð’‹ƒð’•ð’„°ð’„¿ð’ˆ¾ð’˜	ð’€ð’£	ð’ƒ»ð’‹ƒð’–ð’„°	ð’•", 
                {
                    ((1,0),): Sexagesimal("-5"),
                    ((2,0),): Sexagesimal("9"),
                }
            ),
            (
                # -ve - -ve
                # 0 - 5 = -5
                # 4 - 10 = -6
                # -5 - -6 = 1
                "ð’™ð’„¿ð’ˆ¾ð’‘±	ð’€ð’£	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•\nð’Œ‹ð’„¿ð’ˆ¾ð’˜	ð’€ð’£	ð’ƒ»ð’‹ƒð’–ð’„°	ð’•\nð’ƒ»ð’‹ƒð’–ð’„°ð’„¿ð’ˆ¾ð’ƒ»ð’‹ƒð’•ð’„°	ð’€ð’£	ð’ƒ»ð’‹ƒð’—ð’„°	ð’•", 
                {
                    ((1,0),): Sexagesimal("-5"),
                    ((2,0),): Sexagesimal("-6"),
                    ((3,0),): Sexagesimal("1"),
                }
            ),
            (
                # -ve + -ve
                # 0 - 5 = -5
                # 4 - 10 = -6
                # -5 + -6 = -11
                "ð’™ð’„¿ð’ˆ¾ð’‘±	ð’€ð’£	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•\nð’Œ‹ð’„¿ð’ˆ¾ð’˜	ð’€ð’£	ð’ƒ»ð’‹ƒð’–ð’„°	ð’•\nð’ƒ»ð’‹ƒð’–ð’„°ð’€€ð’ˆ¾ð’ƒ»ð’‹ƒð’•ð’„°	ð’ˆ­ð’„©	ð’ƒ»ð’‹ƒð’—ð’„°	ð’•", 
                {
                    ((1,0),): Sexagesimal("-5"),
                    ((2,0),): Sexagesimal("-6"),
                    ((3,0),): Sexagesimal("-11"),
                }
            ),
            (
                # +ve + -ve
                # 4 - 1 = -3
                # 10 + -3 = 7
                "ð’˜ð’„¿ð’ˆ¾ð’•		ð’€ð’£	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•\nð’ƒ»ð’‹ƒð’•ð’„°ð’€€ð’ˆ¾ð’Œ‹	ð’ˆ­ð’„©	ð’ƒ»ð’‹ƒð’–ð’„°	ð’•", 
                {
                    ((1,0),): Sexagesimal("-3"),
                    ((2,0),): Sexagesimal("7"),
                }
            ),
            (
                # -ve + +ve
                # 4 - 1 = -3
                # -3 + 10 = 7
                "ð’˜ð’„¿ð’ˆ¾ð’•		ð’€ð’£	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•\nð’Œ‹ð’€€ð’ˆ¾ð’ƒ»ð’‹ƒð’•ð’„°	ð’ˆ­ð’„©	ð’ƒ»ð’‹ƒð’–ð’„°	ð’•", 
                {
                    ((1,0),): Sexagesimal("-3"),
                    ((2,0),): Sexagesimal("7"),
                }
            ),
            (
                # -ve * +ve
                # 4 - 1 = -3
                # -3 * 10 = -30
                "ð’˜ð’„¿ð’ˆ¾ð’•		ð’€ð’£	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•\nð’ƒ»ð’‹ƒð’•ð’„°  ð’Œ‹	ð’€€ð’º	ð’ƒ»ð’‹ƒð’–ð’„°	ð’•", 
                {
                    ((1,0),): Sexagesimal("-3"),
                    ((2,0),): Sexagesimal("-30"),
                }
            ),
            (
                # +ve * -ve
                # 4 - 1 = -3
                # 1,4 * -3 = -3,12
                "ð’˜ð’„¿ð’ˆ¾ð’•		ð’€ð’£	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•\nð’• ð’˜  ð’ƒ»ð’‹ƒð’•ð’„°	ð’€€ð’º	ð’ƒ»ð’‹ƒð’–ð’„°	ð’•", 
                {
                    ((1,0),): Sexagesimal("-3"),
                    ((2,0),): Sexagesimal("-3,12"),
                }
            ),
            (
                # -ve * +ve
                # 4 - 1 = -3
                # 0 - 25 = -25
                # -3 * -25 = 1,15
                "ð’˜ð’„¿ð’ˆ¾ð’•		ð’€ð’£	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•\nð’Ž™ð’™ð’„¿ð’ˆ¾ð’‘±	ð’€ð’£	ð’ƒ»ð’‹ƒð’–ð’„°	ð’•\nð’ƒ»ð’‹ƒð’•ð’„°  ð’ƒ»ð’‹ƒð’–ð’„°	ð’€€ð’º	ð’ƒ»ð’‹ƒð’˜ð’„°	ð’•", 
                {
                    ((1,0),): Sexagesimal("-3"),
                    ((2,0),): Sexagesimal("-25"),
                    ((4,0),): Sexagesimal("1,15"),
                }
            ),
        ]

        for string, expected_value in TEST_CASES:
            tree = p.parse(TEMPLATE.format(string))
            program = t.transform(tree)
            program.execute()
            for register, value in expected_value.items():
                self.assertEqual(program.registers[register], value)

    def test_gt(self):
        TEST_CASES = [
            (emeszida.Sexagesimal([(2, 0)]) > emeszida.Sexagesimal([(1,0)]), True),
            (emeszida.Sexagesimal([(2, 0)]) < emeszida.Sexagesimal([(1,0)]), False),
            (emeszida.Sexagesimal([(1, 1)]) > emeszida.Sexagesimal([(2,0)]), True),
            (emeszida.Sexagesimal([(1, 1)]) < emeszida.Sexagesimal([(2,0)]), False),
            (emeszida.Sexagesimal([(1, 1), (0, 0)]) > emeszida.Sexagesimal([(59, 0)]), True),
            (emeszida.Sexagesimal([(1, 1), (0, 0)]) < emeszida.Sexagesimal([(59, 0)]), False),
            (emeszida.Sexagesimal([(1, 1), (0, 0)]) > emeszida.Sexagesimal([(60, 0)]), False),
            (emeszida.Sexagesimal([(1, 1), (0, 0)]) < emeszida.Sexagesimal([(60, 0)]), False),
            (emeszida.Sexagesimal([(1, 1), (5, 0)]) > emeszida.Sexagesimal([(1 ,1), (2, 0)]), True),
            (emeszida.Sexagesimal([(1, 1), (5, 0)]) < emeszida.Sexagesimal([(1 ,1), (2, 0)]), False),
            (emeszida.Sexagesimal([(0, 0), (1, -1)]) > emeszida.Sexagesimal([(0, 0), (0, -1), (1, -2)]), True),
            (emeszida.Sexagesimal([(0, 0), (1, -1)]) < emeszida.Sexagesimal([(0, 0), (0, -1), (1, -2)]), False),
            (emeszida.Sexagesimal([(0, 0), (1, -1)]) > emeszida.Sexagesimal([(0, 0), (2, -1), (1, -2)]), False),
            (emeszida.Sexagesimal([(0, 0), (1, -1)]) < emeszida.Sexagesimal([(0, 0), (2, -1), (1, -2)]), True),
            (emeszida.Sexagesimal("-2") < emeszida.Sexagesimal("1"), True),
            (emeszida.Sexagesimal("-2") < emeszida.Sexagesimal("2"), True),
            (emeszida.Sexagesimal("-2") < emeszida.Sexagesimal("3"), True),
            (emeszida.Sexagesimal("-2") > emeszida.Sexagesimal("1"), False),
            (emeszida.Sexagesimal("-2") > emeszida.Sexagesimal("2"), False),
            (emeszida.Sexagesimal("-2") > emeszida.Sexagesimal("3"), False),
            (emeszida.Sexagesimal("-2") < emeszida.Sexagesimal("-1"), True),
            (emeszida.Sexagesimal("-2") < emeszida.Sexagesimal("-10"), False),
            (emeszida.Sexagesimal("-2") < emeszida.Sexagesimal("-2"), False),
            (emeszida.Sexagesimal("-2") > emeszida.Sexagesimal("-2"), False),
            (emeszida.Sexagesimal("2") < emeszida.Sexagesimal("2"), False),
            (emeszida.Sexagesimal("2") > emeszida.Sexagesimal("2"), False),
            (emeszida.Sexagesimal("-2") < emeszida.Sexagesimal("1;5"), True),
            (emeszida.Sexagesimal("-2;5") < emeszida.Sexagesimal("1;5"), True),
            (emeszida.Sexagesimal("-2;5") < emeszida.Sexagesimal("-2"), True),
        ]

        for value, expected_value in TEST_CASES:
            self.assertEqual(value, expected_value)

    def test_addition(self):
        TEST_CASES = [
            ("ð’‹™ð’•ð’Œ‹ð’•ð’€€ð’ˆ¾ð’•ð’‹™ð’•	ð’ˆ­ð’„©	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(1, 0), (2, -1), (11, -2)])}),
            ## Carrying
            ("ð’Œð’‘±ð’€€ð’ˆ¾ð’Œð’‘±	ð’ˆ­ð’„©	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(1, 2), (0, 1), (0, 0)])}),
            ("ð’ð’€€ð’ˆ¾ð’Œ‹	ð’ˆ­ð’„©	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•",     {((1,0),): Sexagesimal([(1, 1), (0, 0)])}),
            ("ð’ð’ð’€€ð’ˆ¾ð’•	ð’ˆ­ð’„©	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•",     {((1,0),): Sexagesimal([(1, 1), (0, 0)])}),
            ("ð’ð’ð’€€ð’ˆ¾ð’Œ‹ð’•	ð’ˆ­ð’„©	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(1, 1), (10, 0)])}),
            ("ð’Œ‹ð’™ð’€€ð’ˆ¾ð’•	ð’ˆ­ð’„©	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•",     {((1,0),): Sexagesimal([(16, 0)])}),
            ("ð’ð’ð’‘±ð’€€ð’ˆ¾ð’ð’	ð’ˆ­ð’„©	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•\nð’ƒ»ð’‹ƒð’•ð’„°ð’€€ð’ˆ¾ð’•	ð’ˆ­ð’„©	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(1, 2), (0, 1), (0, 0)])}),
            ("ð’ð’ð’‘±ð’€€ð’ˆ¾ð’ð’	ð’ˆ­ð’„©	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•\nð’•ð’€€ð’ˆ¾ð’ƒ»ð’‹ƒð’•ð’„°	ð’ˆ­ð’„©	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(1, 2), (0, 1), (0, 0)])}),
        ]

        for string, expected_value in TEST_CASES:
            tree = p.parse(TEMPLATE.format(string))
            program = t.transform(tree)
            program.execute()
            for register, value in expected_value.items():
                self.assertEqual(program.registers[register], value)

    def test_multiplication(self):
        TEST_CASES = [
            ("ð’•ð’  ð’Ž™ð’œð’Ž™	ð’€€ð’º	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(47, 2), (13, 1), (20, 0)])}),
            ("ð’•  ð’Ž™ð’œð’Ž™	ð’€€ð’º	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(28, 1), (20, 0)])}),
            ("ð’Ž™  ð’—	ð’€€ð’º	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•",     {((1,0),): Sexagesimal([(1, 1), (0, 0)])}),
            ("ð’Œ‹ð’˜ð’Œ  ð’Œ‹ð’˜ð’Œ	ð’€€ð’º	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(3, 3), (30, 2), (15, 1), (0, 0)])}),
            ("ð’•  ð’‹™ð’‘±ð’‘±ð’Œ‹	ð’€€ð’º	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(0, 0), (0, -1), (0, -2), (10, -3)])}),
        ]

        for string, expected_value in TEST_CASES:
            tree = p.parse(TEMPLATE.format(string))
            program = t.transform(tree)
            program.execute()
            for register, value in expected_value.items():
                self.assertEqual(program.registers[register], value)

    def test_subtraction(self):
        TEST_CASES = [
            ("ð’•ð’ð’„¿ð’ˆ¾ð’Ž™ð’œð’Ž™	ð’€ð’£	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(26, 1), (40, 0)])}),
            ("ð’‹™ð’•ð’Œ‹ð’•ð’„¿ð’ˆ¾ð’•ð’‹™ð’•	ð’€ð’£	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(0, 0), (59, -1), (49, -2)])}),
            ("ð’Œð’‘±ð’„¿ð’ˆ¾ð’Œð’‘±	ð’€ð’£	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(0, 0)])}),
            ("ð’Œ‹ð’„¿ð’ˆ¾ð’	ð’€ð’£	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•",     {((1,0),): Sexagesimal([(40, 0)])}),
            ("ð’ ð’•ð’„¿ð’ˆ¾ð’ð’•ð’‘±	ð’€ð’£	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(59, 0)])}),
            ("ð’‹™ð’‘±ð’‘±ð’‘±ð’‘±ð’•ð’„¿ð’ˆ¾ð’•	ð’€ð’£	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal("0;59,59,59,59,59")}),
            ("ð’ð’‘±ð’€€ð’ˆ¾ð’•	ð’ˆ­ð’„©	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•\nð’ƒ»ð’‹ƒð’•ð’„°ð’„¿ð’ˆ¾ð’ð’•ð’‘±	ð’€ð’£	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", 
                {((1,0),): Sexagesimal([(59, 0)])}),
            ("ð’•ð’„¿ð’ˆ¾ð’ð’	ð’€ð’£	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•\nð’ƒ»ð’‹ƒð’•ð’„°ð’„¿ð’ˆ¾ð’ð’ð’‘±	ð’€ð’£	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", 
                {((1,0),): Sexagesimal([(58, 1), (2, 0)])}),
            ("ð’ð’€€ð’ˆ¾ð’	ð’ˆ­ð’„©	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•\nð’ƒ»ð’‹ƒð’•ð’„°ð’„¿ð’ˆ¾ð’ð’	ð’€ð’£	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", 
                {((1,0),): Sexagesimal([(0, 0)])}),
            # Negatives
            ("ð’Œ‹ð’•  ð’•	ð’€ð’£	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal("-10")}),
        ]

        for string, expected_value in TEST_CASES:
            tree = p.parse(TEMPLATE.format(string))
            program = t.transform(tree)
            program.execute()
            for register, value in expected_value.items():
                self.assertEqual(program.registers[register], value)

    def test_reciprocal(self):
        TEST_CASES = [
            ("ð’•	ð’…†	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•",     {((1,0),): Sexagesimal([(1, 0)])}),
            ("ð’›ð’Œ	ð’…†	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(0, 0), (0, -1), (8, -2)])}),
            ("ð’Œ‹ð’™	ð’…†	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(0, 0), (4, -1)])}),
            ("ð’Œ‹ð’™ð’‘±	ð’…†	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(0, 0), (0, -1), (4, -2)])}),
            ("ð’Œ‹	ð’…†	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•",     {((1,0),): Sexagesimal([(0, 0), (6, -1)])}),
            ("ð’‹™ð’Œ‹	ð’…†	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(6, 0)])}),
            ("ð’‹™ð’‘±ð’‘±ð’Œ‹	ð’…†	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(6, 2), (0, 1), (0, 0)])}),
            ("ð’›ð’‹™ð’Œ	ð’…†	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", {((1,0),): Sexagesimal([(0, 0), (8, -1)])}),
            ("ð’–	ð’…†	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•\nð’ƒ»ð’‹ƒð’•ð’„°  ð’Œ‹	ð’€€ð’º	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•",  
                {((1,0),): Sexagesimal([(5, 0)])}),
            # Non-Terminating
            ("ð’›	ð’…†	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•",     {((1,0),): Sexagesimal("0;8,0,34,0,17,0,8,0,34")}),
        ]

        for string, expected_value in TEST_CASES:
            tree = p.parse(TEMPLATE.format(string))
            program = t.transform(tree)
            program.execute()
            for register, value in expected_value.items():
                self.assertEqual(program.registers[register], value)

    def test_sequence(self):
        TEST_CASES = [
            # "3000 to 1 add, from 3060 subtract = 59"
            ("ð’ð’‘±ð’€€ð’ˆ¾ð’•	ð’ˆ­ð’„©	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•\nð’ƒ»ð’‹ƒð’•ð’„°ð’„¿ð’ˆ¾ð’ð’•ð’‘±	ð’€ð’£	ð’ƒ»ð’‹ƒð’•ð’„°	ð’•", 
                {((1,0),): Sexagesimal([(59,0)])}),
        ]

        for string, expected_value in TEST_CASES:
            tree = p.parse(TEMPLATE.format(string))
            program = t.transform(tree)
            program.execute()
            for register, value in expected_value.items():
                self.assertEqual(program.registers[register], value)

if __name__ == "__main__":
    unittest.main()
